<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; fill: #34495e; }
      .step-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .step-text { font-family: Arial, sans-serif; font-size: 11px; fill: #2c3e50; }
      .time-label { font-family: Arial, sans-serif; font-size: 12px; fill: #e74c3c; font-weight: bold; }
      .arrow { stroke: #3498db; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .data-arrow { stroke: #e74c3c; stroke-width: 3; fill: none; marker-end: url(#redarrow); }
      .process-arrow { stroke: #f39c12; stroke-width: 2; fill: none; marker-end: url(#orangearrow); }
      .source-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .process-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .storage-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .analysis-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .output-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .sync-box { fill: #34495e; stroke: #2c3e50; stroke-width: 2; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498db"/>
    </marker>
    <marker id="redarrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/>
    </marker>
    <marker id="orangearrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f39c12"/>
    </marker>
  </defs>
  
  <!-- 背景 -->
  <rect width="1400" height="900" fill="#ecf0f1"/>
  
  <!-- 标题 -->
  <text x="700" y="30" text-anchor="middle" class="title">数据流程架构图</text>
  <text x="700" y="55" text-anchor="middle" class="subtitle">T-1数据同步策略 + 多源数据整合 + AI训练流程</text>
  
  <!-- T-1时间策略标识 -->
  <rect x="50" y="80" width="200" height="40" fill="#e74c3c" rx="5"/>
  <text x="150" y="105" text-anchor="middle" class="time-label" fill="white">T-1 时间策略</text>
  
  <!-- 数据源层 (第1层) -->
  <text x="70" y="150" class="step-title">1. 外部数据源</text>
  
  <!-- OpenDota API -->
  <rect x="50" y="170" width="150" height="80" class="source-box" rx="8"/>
  <text x="125" y="195" text-anchor="middle" class="step-title" fill="white">OpenDota API</text>
  <text x="125" y="210" text-anchor="middle" class="step-text" fill="white">• 职业比赛数据</text>
  <text x="125" y="225" text-anchor="middle" class="step-text" fill="white">• 选手统计</text>
  <text x="125" y="240" text-anchor="middle" class="step-text" fill="white">• 英雄数据</text>
  
  <!-- STRATZ API -->
  <rect x="220" y="170" width="150" height="80" class="source-box" rx="8"/>
  <text x="295" y="195" text-anchor="middle" class="step-title" fill="white">STRATZ API</text>
  <text x="295" y="210" text-anchor="middle" class="step-text" fill="white">• 高级统计</text>
  <text x="295" y="225" text-anchor="middle" class="step-text" fill="white">• GraphQL查询</text>
  <text x="295" y="240" text-anchor="middle" class="step-text" fill="white">• 实时数据</text>
  
  <!-- Liquipedia -->
  <rect x="390" y="170" width="150" height="80" class="source-box" rx="8"/>
  <text x="465" y="195" text-anchor="middle" class="step-title" fill="white">Liquipedia</text>
  <text x="465" y="210" text-anchor="middle" class="step-text" fill="white">• 战队信息</text>
  <text x="465" y="225" text-anchor="middle" class="step-text" fill="white">• 锦标赛数据</text>
  <text x="465" y="240" text-anchor="middle" class="step-text" fill="white">• 选手资料</text>
  
  <!-- DEM文件 -->
  <rect x="560" y="170" width="150" height="80" class="source-box" rx="8"/>
  <text x="635" y="195" text-anchor="middle" class="step-title" fill="white">DEM文件</text>
  <text x="635" y="210" text-anchor="middle" class="step-text" fill="white">• 比赛录像</text>
  <text x="635" y="225" text-anchor="middle" class="step-text" fill="white">• 详细事件</text>
  <text x="635" y="240" text-anchor="middle" class="step-text" fill="white">• 位置数据</text>
  
  <!-- 数据获取层 (第2层) -->
  <text x="800" y="150" class="step-title">2. 数据获取服务</text>
  
  <rect x="780" y="170" width="200" height="80" class="process-box" rx="8"/>
  <text x="880" y="195" text-anchor="middle" class="step-title" fill="white">UnifiedDataService</text>
  <text x="880" y="210" text-anchor="middle" class="step-text" fill="white">• 并发数据获取</text>
  <text x="880" y="225" text-anchor="middle" class="step-text" fill="white">• 速率限制控制</text>
  <text x="880" y="240" text-anchor="middle" class="step-text" fill="white">• 错误重试机制</text>
  
  <!-- 定时任务调度 -->
  <rect x="1020" y="170" width="180" height="80" class="sync-box" rx="8"/>
  <text x="1110" y="195" text-anchor="middle" class="step-title" fill="white">Celery 定时任务</text>
  <text x="1110" y="210" text-anchor="middle" class="step-text" fill="white">• 凌晨1点: T-1同步</text>
  <text x="1110" y="225" text-anchor="middle" class="step-text" fill="white">• 凌晨2点: 统计计算</text>
  <text x="1110" y="240" text-anchor="middle" class="step-text" fill="white">• 每4小时: 增量同步</text>
  
  <!-- 数据处理层 (第3层) -->
  <text x="70" y="300" class="step-title">3. 数据处理与清洗</text>
  
  <!-- 数据质量评估 -->
  <rect x="50" y="320" width="160" height="80" class="process-box" rx="8"/>
  <text x="130" y="345" text-anchor="middle" class="step-title" fill="white">数据质量评估</text>
  <text x="130" y="360" text-anchor="middle" class="step-text" fill="white">• 完整性检查</text>
  <text x="130" y="375" text-anchor="middle" class="step-text" fill="white">• 准确性验证</text>
  <text x="130" y="390" text-anchor="middle" class="step-text" fill="white">• 一致性修复</text>
  
  <!-- 数据清洗 -->
  <rect x="230" y="320" width="160" height="80" class="process-box" rx="8"/>
  <text x="310" y="345" text-anchor="middle" class="step-title" fill="white">数据清洗</text>
  <text x="310" y="360" text-anchor="middle" class="step-text" fill="white">• 重复数据去除</text>
  <text x="310" y="375" text-anchor="middle" class="step-text" fill="white">• 格式标准化</text>
  <text x="310" y="390" text-anchor="middle" class="step-text" fill="white">• 缺失值处理</text>
  
  <!-- 数据整合 -->
  <rect x="410" y="320" width="160" height="80" class="process-box" rx="8"/>
  <text x="490" y="345" text-anchor="middle" class="step-title" fill="white">多源数据整合</text>
  <text x="490" y="360" text-anchor="middle" class="step-text" fill="white">• 数据源优先级</text>
  <text x="490" y="375" text-anchor="middle" class="step-text" fill="white">• 字段映射</text>
  <text x="490" y="390" text-anchor="middle" class="step-text" fill="white">• 冲突解决</text>
  
  <!-- DEM处理 -->
  <rect x="590" y="320" width="160" height="80" class="process-box" rx="8"/>
  <text x="670" y="345" text-anchor="middle" class="step-title" fill="white">DEM文件处理</text>
  <text x="670" y="360" text-anchor="middle" class="step-text" fill="white">• 文件下载</text>
  <text x="670" y="375" text-anchor="middle" class="step-text" fill="white">• JSON转换</text>
  <text x="670" y="390" text-anchor="middle" class="step-text" fill="white">• OSS上传</text>
  
  <!-- 数据存储层 (第4层) -->
  <text x="800" y="300" class="step-title">4. 数据存储</text>
  
  <!-- PostgreSQL -->
  <rect x="780" y="320" width="140" height="80" class="storage-box" rx="8"/>
  <text x="850" y="345" text-anchor="middle" class="step-title" fill="white">PostgreSQL</text>
  <text x="850" y="360" text-anchor="middle" class="step-text" fill="white">• 结构化数据</text>
  <text x="850" y="375" text-anchor="middle" class="step-text" fill="white">• 关系数据</text>
  <text x="850" y="390" text-anchor="middle" class="step-text" fill="white">• 事务支持</text>
  
  <!-- Redis缓存 -->
  <rect x="940" y="320" width="140" height="80" class="storage-box" rx="8"/>
  <text x="1010" y="345" text-anchor="middle" class="step-title" fill="white">Redis缓存</text>
  <text x="1010" y="360" text-anchor="middle" class="step-text" fill="white">• 热点数据</text>
  <text x="1010" y="375" text-anchor="middle" class="step-text" fill="white">• 会话存储</text>
  <text x="1010" y="390" text-anchor="middle" class="step-text" fill="white">• 任务队列</text>
  
  <!-- 阿里云OSS -->
  <rect x="1100" y="320" width="140" height="80" class="storage-box" rx="8"/>
  <text x="1170" y="345" text-anchor="middle" class="step-title" fill="white">阿里云OSS</text>
  <text x="1170" y="360" text-anchor="middle" class="step-text" fill="white">• DEM文件</text>
  <text x="1170" y="375" text-anchor="middle" class="step-text" fill="white">• 静态资源</text>
  <text x="1170" y="390" text-anchor="middle" class="step-text" fill="white">• 备份数据</text>
  
  <!-- 数据分析层 (第5层) -->
  <text x="70" y="450" class="step-title">5. 数据分析与统计</text>
  
  <!-- 统计分析服务 -->
  <rect x="50" y="470" width="160" height="80" class="analysis-box" rx="8"/>
  <text x="130" y="495" text-anchor="middle" class="step-title" fill="white">StatisticsService</text>
  <text x="130" y="510" text-anchor="middle" class="step-text" fill="white">• 英雄胜率分析</text>
  <text x="130" y="525" text-anchor="middle" class="step-text" fill="white">• 比赛数据统计</text>
  <text x="130" y="540" text-anchor="middle" class="step-text" fill="white">• 选手表现分析</text>
  
  <!-- 图表生成 -->
  <rect x="230" y="470" width="160" height="80" class="analysis-box" rx="8"/>
  <text x="310" y="495" text-anchor="middle" class="step-title" fill="white">图表数据生成</text>
  <text x="310" y="510" text-anchor="middle" class="step-text" fill="white">• ECharts数据</text>
  <text x="310" y="525" text-anchor="middle" class="step-text" fill="white">• D3.js数据</text>
  <text x="310" y="540" text-anchor="middle" class="step-text" fill="white">• 可视化配置</text>
  
  <!-- 实时分析 -->
  <rect x="410" y="470" width="160" height="80" class="analysis-box" rx="8"/>
  <text x="490" y="495" text-anchor="middle" class="step-title" fill="white">实时数据分析</text>
  <text x="490" y="510" text-anchor="middle" class="step-text" fill="white">• WebSocket推送</text>
  <text x="490" y="525" text-anchor="middle" class="step-text" fill="white">• 增量更新</text>
  <text x="490" y="540" text-anchor="middle" class="step-text" fill="white">• 缓存策略</text>
  
  <!-- AI训练数据层 (第6层) -->
  <text x="600" y="450" class="step-title">6. AI训练数据准备</text>
  
  <!-- 训练数据生成 -->
  <rect x="580" y="470" width="160" height="80" class="output-box" rx="8"/>
  <text x="660" y="495" text-anchor="middle" class="step-title" fill="white">训练数据生成</text>
  <text x="660" y="510" text-anchor="middle" class="step-text" fill="white">• DeepSeek格式</text>
  <text x="660" y="525" text-anchor="middle" class="step-text" fill="white">• 数据标注</text>
  <text x="660" y="540" text-anchor="middle" class="step-text" fill="white">• 质量验证</text>
  
  <!-- AI模型训练 -->
  <rect x="760" y="470" width="160" height="80" class="output-box" rx="8"/>
  <text x="840" y="495" text-anchor="middle" class="step-title" fill="white">AI模型训练</text>
  <text x="840" y="510" text-anchor="middle" class="step-text" fill="white">• 模型微调</text>
  <text x="840" y="525" text-anchor="middle" class="step-text" fill="white">• 效果评估</text>
  <text x="840" y="540" text-anchor="middle" class="step-text" fill="white">• 模型部署</text>
  
  <!-- AI助手服务 -->
  <rect x="940" y="470" width="160" height="80" class="output-box" rx="8"/>
  <text x="1020" y="495" text-anchor="middle" class="step-title" fill="white">AI智能助手</text>
  <text x="1020" y="510" text-anchor="middle" class="step-text" fill="white">• 比赛分析</text>
  <text x="1020" y="525" text-anchor="middle" class="step-text" fill="white">• 学习推荐</text>
  <text x="1020" y="540" text-anchor="middle" class="step-text" fill="white">• 智能问答</text>
  
  <!-- 输出层 (第7层) -->
  <text x="70" y="600" class="step-title">7. 前端展示与用户交互</text>
  
  <!-- API接口 -->
  <rect x="50" y="620" width="150" height="80" class="output-box" rx="8"/>
  <text x="125" y="645" text-anchor="middle" class="step-title" fill="white">REST API</text>
  <text x="125" y="660" text-anchor="middle" class="step-text" fill="white">• 统计数据API</text>
  <text x="125" y="675" text-anchor="middle" class="step-text" fill="white">• 图表数据API</text>
  <text x="125" y="690" text-anchor="middle" class="step-text" fill="white">• 实时数据API</text>
  
  <!-- 数据可视化 -->
  <rect x="220" y="620" width="150" height="80" class="output-box" rx="8"/>
  <text x="295" y="645" text-anchor="middle" class="step-title" fill="white">数据可视化</text>
  <text x="295" y="660" text-anchor="middle" class="step-text" fill="white">• ECharts图表</text>
  <text x="295" y="675" text-anchor="middle" class="step-text" fill="white">• D3.js交互</text>
  <text x="295" y="690" text-anchor="middle" class="step-text" fill="white">• 响应式设计</text>
  
  <!-- 用户界面 -->
  <rect x="390" y="620" width="150" height="80" class="output-box" rx="8"/>
  <text x="465" y="645" text-anchor="middle" class="step-title" fill="white">用户界面</text>
  <text x="465" y="660" text-anchor="middle" class="step-text" fill="white">• 分析仪表盘</text>
  <text x="465" y="675" text-anchor="middle" class="step-text" fill="white">• 交互控制</text>
  <text x="465" y="690" text-anchor="middle" class="step-text" fill="white">• 实时更新</text>
  
  <!-- 社区功能 -->
  <rect x="560" y="620" width="150" height="80" class="output-box" rx="8"/>
  <text x="635" y="645" text-anchor="middle" class="step-title" fill="white">社区功能</text>
  <text x="635" y="660" text-anchor="middle" class="step-text" fill="white">• 专家观点</text>
  <text x="635" y="675" text-anchor="middle" class="step-text" fill="white">• 用户讨论</text>
  <text x="635" y="690" text-anchor="middle" class="step-text" fill="white">• 学习中心</text>
  
  <!-- AI智能服务 -->
  <rect x="730" y="620" width="150" height="80" class="output-box" rx="8"/>
  <text x="805" y="645" text-anchor="middle" class="step-title" fill="white">AI智能服务</text>
  <text x="805" y="660" text-anchor="middle" class="step-text" fill="white">• 智能推荐</text>
  <text x="805" y="675" text-anchor="middle" class="step-text" fill="white">• 比赛预测</text>
  <text x="805" y="690" text-anchor="middle" class="step-text" fill="white">• 个性化内容</text>
  
  <!-- 数据流连接线 -->
  <!-- 数据源到数据获取 -->
  <line x1="125" y1="250" x2="880" y2="170" class="data-arrow"/>
  <line x1="295" y1="250" x2="880" y2="180" class="data-arrow"/>
  <line x1="465" y1="250" x2="880" y2="190" class="data-arrow"/>
  <line x1="635" y1="250" x2="880" y2="200" class="data-arrow"/>
  
  <!-- 定时任务到数据获取 -->
  <line x1="1020" y1="210" x2="980" y2="210" class="process-arrow"/>
  
  <!-- 数据获取到数据处理 -->
  <line x1="880" y1="250" x2="130" y2="320" class="arrow"/>
  <line x1="880" y1="250" x2="310" y2="320" class="arrow"/>
  <line x1="880" y1="250" x2="490" y2="320" class="arrow"/>
  <line x1="880" y1="250" x2="670" y2="320" class="arrow"/>
  
  <!-- 数据处理到存储 -->
  <line x1="490" y1="400" x2="850" y2="320" class="arrow"/>
  <line x1="490" y1="400" x2="1010" y2="320" class="arrow"/>
  <line x1="670" y1="400" x2="1170" y2="320" class="arrow"/>
  
  <!-- 存储到分析 -->
  <line x1="850" y1="400" x2="130" y2="470" class="arrow"/>
  <line x1="850" y1="400" x2="310" y2="470" class="arrow"/>
  <line x1="850" y1="400" x2="490" y2="470" class="arrow"/>
  
  <!-- 存储到AI训练 -->
  <line x1="850" y1="400" x2="660" y2="470" class="arrow"/>
  <line x1="850" y1="400" x2="840" y2="470" class="arrow"/>
  <line x1="850" y1="400" x2="1020" y2="470" class="arrow"/>
  
  <!-- 分析到输出 -->
  <line x1="310" y1="550" x2="125" y2="620" class="arrow"/>
  <line x1="310" y1="550" x2="295" y2="620" class="arrow"/>
  <line x1="310" y1="550" x2="465" y2="620" class="arrow"/>
  <line x1="490" y1="550" x2="635" y2="620" class="arrow"/>
  
  <!-- AI到输出 -->
  <line x1="1020" y1="550" x2="805" y2="620" class="arrow"/>
  
  <!-- 时间标识 -->
  <text x="50" y="780" class="time-label">定时调度时间表:</text>
  <text x="50" y="800" class="step-text">• 凌晨1点: T-1完整数据同步 (前一天数据)</text>
  <text x="50" y="815" class="step-text">• 凌晨2点: 每日统计计算和缓存更新</text>
  <text x="50" y="830" class="step-text">• 凌晨3点: 英雄Meta统计更新</text>
  <text x="50" y="845" class="step-text">• 凌晨4点: 过期数据清理</text>
  <text x="50" y="860" class="step-text">• 每30分钟: 预测结果解析</text>
  <text x="50" y="875" class="step-text">• 每4小时: 增量比赛数据同步</text>
  
  <text x="600" y="780" class="time-label">数据质量保证:</text>
  <text x="600" y="800" class="step-text">• 多源数据交叉验证</text>
  <text x="600" y="815" class="step-text">• 自动重复数据检测</text>
  <text x="600" y="830" class="step-text">• 数据一致性修复</text>
  <text x="600" y="845" class="step-text">• 异常数据告警</text>
  <text x="600" y="860" class="step-text">• 数据完整性评分</text>
  
</svg>


